{"mappings":"AACE,MAAMA,EAAO,CAEXC,cAAeC,SAASC,cAAc,sBACtCC,MAAOF,SAASC,cAAc,gBAC9BE,UAAWH,SAASC,cAAc,kBAClCG,KAAMJ,SAASC,cAAc,YAC7BI,KAAML,SAASC,cAAc,aAM3BK,EAAWC,KAAKC,MAAMC,aAAaC,QADlB,cAC8C,GAI/DC,EAAOX,SAASY,iBAAiB,qBAEvC,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC5BF,EAAKE,GAAGE,iBAAiB,QAASC,GAKjBT,KAAKC,MAAMC,aAAaC,QAdzB,UAiBrB,SAASM,EAAUC,GACnB,GAAIA,EAAIC,OAAOC,UAAUC,SAAS,OAC/B,OAEDtB,EAAKI,MAAMiB,UAAUE,OAAO,aAG5B,MACMC,EADUL,EAAIC,OAAOK,QAAQ,qBACTC,QAAQC,GAC5BC,EAAiBpB,EAASqB,MAAK,EAACC,IAAEA,KAAUA,IAAQN,IAE5Db,aAAaoB,QA5BQ,QA4BctB,KAAKuB,UAAUJ,IAClD,MAAMK,EAAgBxB,KAAKC,MAAMC,aAAaC,QA7BzB,WA6BmD,GAcxE,IAA2BsB,EAb1BlC,EAAKK,UAAU8B,mBAAmB,YActB,wBADcD,EAbuCD,GAe1CH,4JAGeI,EAAIE,oBAAoBF,EAAIG,oFAE5BH,EAAIG,oDACJH,EAAII,yDACCJ,EAAIK,wFAG7BL,EAAIM,UAAU,GAAGC,uKACgDP,EAAIM,UAAU,GAAGE,6CAElFR,EAAIM,UAAU,GAAGC,8JAC2CP,EAAIM,UAAU,GAAGE,4CAE7ER,EAAIM,UAAU,GAAGC,2KACoDP,EAAIM,UAAU,GAAGE,4W,CAtBzG1C,EAAKC,cAAcgB,iBAAiB,SANpC,WACGjB,EAAKI,MAAMiB,UAAUsB,IAAI,aACzB3C,EAAKK,UAAUuC,UAAY,GAC5BjC,aAAakC,WAAW,Q,IAoE1B7C,EAAKK,UAAUY,iBAAiB,SA9BhC,SAA4BE,GAI3B,IAAKA,EAAIC,OAAOC,UAAUC,SAAS,kBAC5B,OAGJ,MAAMwB,EAAWrC,KAAKC,MAAMC,aAAaC,QAlFtB,cAkFkD,GAEjEmC,EAAU5B,EAAIC,OAAOK,QAAQ,qBACnCuB,QAAQC,IAAIF,GAEV,MAAMvB,EAAYuB,EAAQrB,QAAQC,GAE5BuB,EAAMJ,EAASK,WAAUC,GAAUA,EAAOtB,MAAQN,IAUvD,OARsBsB,EAASjB,MAAK,EAACC,IAAEA,KAAUA,IAAQN,IAE1CsB,EAASO,OAAOH,EAAM,GAEtCvC,aAAaoB,QA/FM,WA+FkBtB,KAAKuB,UAAUc,IAEpDQ,OAAOC,SAASC,KAAO,uBAEfC,aAAaX,E","sources":["src/js/modal-shop.js"],"sourcesContent":["\n  const refs = {\n    \n    closeModalBtn: document.querySelector(\"[data-modal-close]\"),\n    modal: document.querySelector(\"[data-modal]\"),\n    container: document.querySelector(\".js-modal-item\"),\n    book: document.querySelector(\".trigger\"),\n    list: document.querySelector(\".js-list\"),\n   \n};\n  \nconst MODAL_LS_KEY = 'modal';\nconst PRODUCT_LS_KEY = 'checkout';\nconst products = JSON.parse(localStorage.getItem(PRODUCT_LS_KEY)) || [];\n\n\n//  ==============================                \nconst open = document.querySelectorAll(\"[data-modal-open]\")\n\nfor (let i = 0; i < open.length; i++) {\n     open[i].addEventListener(\"click\", openModal);\n}\n \n\n\nconst modalProducts = JSON.parse(localStorage.getItem(MODAL_LS_KEY)) || {};\n\n\nfunction openModal(evt) {\nif (evt.target.classList.contains('img')) {\n   return;\n  }\n  refs.modal.classList.remove(\"is-hidden\");\n  // evt.preventDefault();\n  \n  const product = evt.target.closest(\"[data-modal-open]\");\n  const productId = product.dataset.id;\n  const currentProduct = products.find(({ _id }) => _id === productId);\n  \nlocalStorage.setItem(MODAL_LS_KEY, JSON.stringify(currentProduct))\nconst modalProducts = JSON.parse(localStorage.getItem(MODAL_LS_KEY)) ?? {};\n refs.container.insertAdjacentHTML('beforeend', createModalMarkup(modalProducts));\n}\n  \n\nfunction closeModal() {\n   refs.modal.classList.add(\"is-hidden\");\n   refs.container.innerHTML = \"\"\n  localStorage.removeItem(\"modal\");\n  }\n\nrefs.closeModalBtn.addEventListener(\"click\", closeModal);\n \n\nfunction createModalMarkup(obj) {\n    return   `\n    <div data-id=\"${obj._id}\" class=\"js-modal-product modal-shop-product \" data-modal-open=\"\">\n        \n    <div class=\"mоdal-info-wrap\">\n    <img class=\"modal-shop-img\" src=\"${obj.book_image}\" alt=\"${obj.title}\" />\n        <div class=\"book-info\">\n        <h2 class=\"modal-shop-title\">${obj.title}</h2>\n        <p class=\"modal-shop-author\">${obj.author}</p>\n        <p class=\"modal-shop-description\">${obj.description}</p>\n      \n       <ul class =\"modal-shop-link-list\">\n        <a href=\"${obj.buy_links[0].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link modal-shop-link-amz\">\n        <img class=\"img-modal modal-icon-shop-amz\" src=\"./images/amazon.png\" alt=\"${obj.buy_links[0].name}\"  />\n        </a>\n        <a href=\"${obj.buy_links[1].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link modal-shop-link\">\n       <img class=\"img-modal  modal-icon-shop\" src=\"./images/apple.png\" alt=\"${obj.buy_links[1].name}\" />\n        </a>\n        <a href=\"${obj.buy_links[3].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link modal-shop-link-bsh\">\n        <img class=\"img-modal  modal-icon-shop-bsh\" src=\"./images/bookshops.png\" alt=\"${obj.buy_links[3].name}\"  />\n        </a>\n        </ul>\n        </div>\n        </div>\n        <button class=\"js-modal-clear modal-dlt-btn\" type=\"button\">remove from the shopping list</button>\n        <p class=\"modal-shop-text\">Сongratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”.</p>\n        \n  </div>`\n}\n    \n// =========================================================================\n\nfunction handlerClearBasket(evt) {\n      //  evt.preventDefault();\n   \n\n if (!evt.target.classList.contains('js-modal-clear')) {\n        return;\n    }\n\n    const products = JSON.parse(localStorage.getItem(PRODUCT_LS_KEY)) ?? [];\n \n  const product = evt.target.closest('.js-modal-product');\n  console.log(product);\n  \n    const productId = product.dataset.id;\n\n    const fidx= products.findIndex(option => option._id === productId);\n\n    const currentProduct = products.find(({ _id }) => _id === productId);\n    \n    const deleted = products.splice(fidx, 1);\n\n    localStorage.setItem(PRODUCT_LS_KEY, JSON.stringify(products))\n  \n    window.location.href = './shopping-list.html';\n    \n     return createMarkup(products)\n\n    \n}\n\nrefs.container.addEventListener(\"click\", handlerClearBasket);\n\n"],"names":["$047fa90494f5dee5$var$refs","closeModalBtn","document","querySelector","modal","container","book","list","$047fa90494f5dee5$var$products","JSON","parse","localStorage","getItem","$047fa90494f5dee5$var$open","querySelectorAll","i","length","addEventListener","$047fa90494f5dee5$var$openModal","evt","target","classList","contains","remove","productId","closest","dataset","id","currentProduct","find","_id","setItem","stringify","modalProducts1","obj","insertAdjacentHTML","book_image","title","author","description","buy_links","url","name","add","innerHTML","removeItem","products1","product","console","log","fidx","findIndex","option","splice","window","location","href","createMarkup"],"version":3,"file":"shopping-list.440ec407.js.map"}