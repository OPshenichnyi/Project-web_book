{"mappings":"aAAC,WACC,IAAMA,EAAO,CACXC,aAAcC,SAASC,cAAc,qBACrCC,cAAeF,SAASC,cAAc,sBACtCE,MAAOH,SAASC,cAAc,gBAC9BG,UAAWJ,SAASC,cAAc,mBAMpC,SAASI,IACPP,EAAKK,MAAMG,UAAUC,OAAO,aAC5BT,EAAKM,UAAUI,mBAAmB,YAAaC,EAAaC,G,CAL9DZ,EAAKC,aAAaY,iBAAiB,QAASN,GAC5CP,EAAKI,cAAcS,iBAAiB,QAASN,EAM9C,CAfA,GAkBD,IAAMO,EAAiB,WACjBF,EAAWG,KAAKC,MAAMC,aAAaC,QAAQJ,KAAoB,GAGrE,SAASH,EAAaQ,GAClB,OAAOA,EAAIC,KAAI,SAAAC,G,IAAGC,EAAGD,EAAHC,IAAIC,EAAKF,EAALE,MAAOC,EAAMH,EAANG,OAAQC,EAAWJ,EAAXI,YAAYC,EAAUL,EAAVK,WAAYC,EAASN,EAATM,U,MAAe,yBAGrCC,OADvBN,EAAI,iHACuCM,OAApBF,EAAW,WAEfE,OAFwBL,EAAM,gFAIzBK,OAFLL,EAAM,8DAKNK,OAHKH,EAAY,0FAKrCG,OAFoBJ,EAAO,kEAGsBI,OADjDD,EAAU,GAAGE,IAAI,+IAGjBD,OAFiDD,EAAU,GAAGG,KAAK,+CAGxBF,OAD3CD,EAAU,GAAGE,IAAI,qIAGjBD,OAF2CD,EAAU,GAAGG,KAAK,0CAGbF,OADhDD,EAAU,GAAGE,IAAI,0IACiDD,OAAlBD,EAAU,GAAGG,KAAK,yW,IAQ1EC,KAAK,G,CAOhB,IAHA,IAAMC,EAAQ9B,SAAS+B,iBAAiB,mBAG/BC,EAAI,EAAGA,EAAIF,EAAMG,OAAQD,IAC7BF,EAAME,GAAGrB,iBAAiB,QAASuB,GAMxC,SAASA,EAAmBC,GAI3B,GAHMA,EAAIC,iBAGLD,EAAIE,OAAO/B,UAAUgC,SAAS,kBAAnC,C,IAIoBC,EAAXC,EAA2D,QAAhDD,EAAA1B,KAAKC,MAAMC,aAAaC,QAAQJ,WAAgB,IAAhD2B,IAAoD,GAI/DE,EAFUN,EAAIE,OAAOK,QAAQ,qBAETC,QAAQC,GAE5BC,EAAML,EAASM,WAAU,SAAAC,G,OAAUA,EAAO3B,MAAQqB,C,IAEjCD,EAASQ,MAAK,SAAA7B,G,OAAMA,EAAHC,MAAkBqB,C,IAE9CD,EAASS,MAAK,SAAA9B,G,OAAMA,EAAHC,MAAkBqB,C,IAE/BD,EAASU,OAAOL,EAAM,GAMrC,OAJD9B,aAAaoC,QAAQvC,EAAgBC,KAAKuC,UAAUZ,IAEpDa,OAAOC,SAASC,KAAO,uBAEf9C,EAAa+B,EArBjB,C","sources":["src/js/modal-shop.js"],"sourcesContent":["(() => {\n  const refs = {\n    openModalBtn: document.querySelector(\"[data-modal-open]\"),\n    closeModalBtn: document.querySelector(\"[data-modal-close]\"),\n    modal: document.querySelector(\"[data-modal]\"),\n    container: document.querySelector(\".js-modal-item\"),\n  };\n\n  refs.openModalBtn.addEventListener(\"click\", toggleModal);\n  refs.closeModalBtn.addEventListener(\"click\", toggleModal);\n\n  function toggleModal() {\n    refs.modal.classList.toggle(\"is-hidden\");\n    refs.container.insertAdjacentHTML('beforeend', createMarkup(products));\n  }\n})();\n\n\nconst PRODUCT_LS_KEY = 'checkout';\nconst products = JSON.parse(localStorage.getItem(PRODUCT_LS_KEY)) || [];\n\n\nfunction createMarkup(arr) {\n    return arr.map(({ _id,title, author, description,book_image, buy_links}) => `\n\n    <div data-id=\"${_id}\" class=\"js-modal-product modal-shop-product \" data-modal-open=\"\">\n        <img class=\"modal-shop-img\" src=\"${book_image}\" alt=\"${title}\" />\n        <div class=\"book-info\">\n        <h2 class=\"modal-shop-title\">${title}</h2>\n       \n        <p class=\"modal-shop-description\">${description}</p>\n        \n        <div class=\"shop-wrap\">\n        <p class=\"modal-shop-author\">${author}</p>  \n       <ul class =\"shop-link-list\">\n        <a href=\"${buy_links[0].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link shop-link-amz\">\n        <img class=\"icon-shop-amz\" src=\"./images/amazon.png\" alt=\"${buy_links[0].name}\"  />     \n        </a>\n        <a href=\"${buy_links[1].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link shop-link\">\n       <img class=\"icon-shop\" src=\"./images/apple.png\" alt=\"${buy_links[1].name}\" /> \n        </a>\n        <a href=\"${buy_links[3].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link shop-link\">\n        <img class=\"icon-shop\" src=\"./images/bookshops.png\" alt=\"${buy_links[3].name}\"  /> \n        </a>\n        </ul>\n        \n        </div>\n        <button class=\"js-modal-clear modal-dlt-btn\" type=\"button\">remove from the shopping list</button>\n        <p class=\"modal-shop-text\">Сongratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”.</p>\n        </div>\n  </div>`).join('')\n}\n\n               \nconst clear = document.querySelectorAll('.js-modal-clear')\n\n\nfor (let i = 0; i < clear.length; i++) {\n     clear[i].addEventListener(\"click\", handlerClearBasket\n      \n     );\n }\n// clear.addEventListener('click', handlerClearBasket)\n\nfunction handlerClearBasket(evt) {\n       evt.preventDefault();\n   \n\n if (!evt.target.classList.contains('js-modal-clear')) {\n        return;\n    }\n\n    const products = JSON.parse(localStorage.getItem(PRODUCT_LS_KEY)) ?? [];\n \n    const product = evt.target.closest('.js-modal-product');\n  \n    const productId = product.dataset.id;\n\n    const fidx= products.findIndex(option => option._id === productId);\n\n    const currentProduct = products.find(({ _id }) => _id === productId);\n    \n    const idx = products.some(({ _id }) => _id === productId);\n\n    const deleted = products.splice(fidx, 1);\n\n    localStorage.setItem(PRODUCT_LS_KEY, JSON.stringify(products))\n    \n    window.location.href = './shopping-list.html';\n    \n     return createMarkup(products)\n\n    \n}\n\n\n"],"names":["refs","openModalBtn","document","querySelector","closeModalBtn","modal","container","toggleModal","classList","toggle","insertAdjacentHTML","$1aafc7bd588ab95c$var$createMarkup","$1aafc7bd588ab95c$var$products","addEventListener","$1aafc7bd588ab95c$var$PRODUCT_LS_KEY","JSON","parse","localStorage","getItem","arr","map","param","_id","title","author","description","book_image","buy_links","concat","url","name","join","$1aafc7bd588ab95c$var$clear","querySelectorAll","$1aafc7bd588ab95c$var$i","length","$1aafc7bd588ab95c$var$handlerClearBasket","evt","preventDefault","target","contains","ref","products1","productId","closest","dataset","id","fidx","findIndex","option","find","some","splice","setItem","stringify","window","location","href"],"version":3,"file":"shopping-list.4108e0fc.js.map"}