{"mappings":"YAmBA,IAlBE,IAAMA,EAAO,CAEXC,cAAeC,SAASC,cAAc,sBACtCC,MAAOF,SAASC,cAAc,gBAC9BE,UAAWH,SAASC,cAAc,kBAClCG,KAAMJ,SAASC,cAAc,YAC7BI,KAAML,SAASC,cAAc,aAI3BK,EAAe,QACfC,EAAiB,WACjBC,EAAWC,KAAKC,MAAMC,aAAaC,QAAQL,KAAoB,GAI/DM,EAAOb,SAASc,iBAAiB,qBAE9BC,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC5BF,EAAKE,GAAGE,iBAAiB,QAASC,GAKjBT,KAAKC,MAAMC,aAAaC,QAAQN,IAGtD,SAASY,EAAUC,GACnB,IAAIA,EAAIC,OAAOC,UAAUC,SAAS,OAAlC,CAGExB,EAAKI,MAAMmB,UAAUE,OAAO,aAG5B,IAKoBC,EAJdC,EADUN,EAAIC,OAAOM,QAAQ,qBACTC,QAAQC,GAC5BC,EAAiBrB,EAASsB,MAAK,SAAAC,G,OAAMA,EAAHC,MAAkBP,C,IAE5Dd,aAAasB,QAAQ3B,EAAcG,KAAKyB,UAAUL,IAClD,IAc2BM,EAdrBC,EAA8D,QAA9CZ,EAAAf,KAAKC,MAAMC,aAAaC,QAAQN,WAAc,IAA9CkB,IAAkD,GACvE1B,EAAKK,UAAUkC,mBAAmB,YActB,uBAI0BC,QALZH,EAbuCC,GAe1CJ,IAAI,0JAGmCM,OAAxBH,EAAII,WAAW,WAEfD,OAFwBH,EAAIK,MAAM,gFAGlCF,OADAH,EAAIK,MAAM,gDAELF,OADLH,EAAIM,OAAO,oDAI/BH,OAHyBH,EAAIO,YAAY,8EAIwBJ,OADjEH,EAAIQ,UAAU,GAAGC,IAAI,qKAGrBN,OAFiEH,EAAIQ,UAAU,GAAGE,KAAK,0CAG3BP,OAD5DH,EAAIQ,UAAU,GAAGC,IAAI,4JAGrBN,OAF4DH,EAAIQ,UAAU,GAAGE,KAAK,yCAGbP,OADrEH,EAAIQ,UAAU,GAAGC,IAAI,yKACsEN,OAAtBH,EAAIQ,UAAU,GAAGE,KAAK,yWA3C3G,C,CAqBH/C,EAAKC,cAAckB,iBAAiB,SANpC,WACGnB,EAAKI,MAAMmB,UAAUyB,IAAI,aACzBhD,EAAKK,UAAU4C,UAAY,GAC5BpC,aAAaqC,WAAW,Q,IAoE1BlD,EAAKK,UAAUc,iBAAiB,SA9BhC,SAA4BE,GAI3B,GAAKA,EAAIC,OAAOC,UAAUC,SAAS,kBAAnC,C,IAIoBE,EAAXyB,EAA2D,QAAhDzB,EAAAf,KAAKC,MAAMC,aAAaC,QAAQL,WAAgB,IAAhDiB,IAAoD,GAEjE0B,EAAU/B,EAAIC,OAAOM,QAAQ,qBACnCyB,QAAQC,IAAIF,GAEV,IAAMzB,EAAYyB,EAAQvB,QAAQC,GAE5ByB,EAAMJ,EAASK,WAAU,SAAAC,G,OAAUA,EAAOvB,MAAQP,C,IAEjCwB,EAASnB,MAAK,SAAAC,G,OAAMA,EAAHC,MAAkBP,C,IAE1CwB,EAASO,OAAOH,EAAM,GAMrC,OAJD1C,aAAasB,QAAQ1B,EAAgBE,KAAKyB,UAAUe,IAEpDQ,OAAOC,SAASC,KAAO,uBAEfC,aAAaX,EApBjB,C","sources":["src/js/modal-shop.js"],"sourcesContent":["\n  const refs = {\n    \n    closeModalBtn: document.querySelector(\"[data-modal-close]\"),\n    modal: document.querySelector(\"[data-modal]\"),\n    container: document.querySelector(\".js-modal-item\"),\n    book: document.querySelector(\".trigger\"),\n    list: document.querySelector(\".js-list\"),\n   \n};\n  \nconst MODAL_LS_KEY = 'modal';\nconst PRODUCT_LS_KEY = 'checkout';\nconst products = JSON.parse(localStorage.getItem(PRODUCT_LS_KEY)) || [];\n\n\n//  ==============================                \nconst open = document.querySelectorAll(\"[data-modal-open]\")\n\nfor (let i = 0; i < open.length; i++) {\n     open[i].addEventListener(\"click\", openModal);\n}\n \n\n\nconst modalProducts = JSON.parse(localStorage.getItem(MODAL_LS_KEY)) || {};\n\n\nfunction openModal(evt) {\nif (evt.target.classList.contains('img')) {\n   return;\n  }\n  refs.modal.classList.remove(\"is-hidden\");\n  // evt.preventDefault();\n  \n  const product = evt.target.closest(\"[data-modal-open]\");\n  const productId = product.dataset.id;\n  const currentProduct = products.find(({ _id }) => _id === productId);\n  \nlocalStorage.setItem(MODAL_LS_KEY, JSON.stringify(currentProduct))\nconst modalProducts = JSON.parse(localStorage.getItem(MODAL_LS_KEY)) ?? {};\n refs.container.insertAdjacentHTML('beforeend', createModalMarkup(modalProducts));\n}\n  \n\nfunction closeModal() {\n   refs.modal.classList.add(\"is-hidden\");\n   refs.container.innerHTML = \"\"\n  localStorage.removeItem(\"modal\");\n  }\n\nrefs.closeModalBtn.addEventListener(\"click\", closeModal);\n \n\nfunction createModalMarkup(obj) {\n    return   `\n    <div data-id=\"${obj._id}\" class=\"js-modal-product modal-shop-product \" data-modal-open=\"\">\n        \n    <div class=\"mоdal-info-wrap\">\n    <img class=\"modal-shop-img\" src=\"${obj.book_image}\" alt=\"${obj.title}\" />\n        <div class=\"book-info\">\n        <h2 class=\"modal-shop-title\">${obj.title}</h2>\n        <p class=\"modal-shop-author\">${obj.author}</p>\n        <p class=\"modal-shop-description\">${obj.description}</p>\n      \n       <ul class =\"modal-shop-link-list\">\n        <a href=\"${obj.buy_links[0].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link modal-shop-link-amz\">\n        <img class=\"img-modal modal-icon-shop-amz\" src=\"./images/amazon.png\" alt=\"${obj.buy_links[0].name}\"  />\n        </a>\n        <a href=\"${obj.buy_links[1].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link modal-shop-link\">\n       <img class=\"img-modal  modal-icon-shop\" src=\"./images/apple.png\" alt=\"${obj.buy_links[1].name}\" />\n        </a>\n        <a href=\"${obj.buy_links[3].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link modal-shop-link-bsh\">\n        <img class=\"img-modal  modal-icon-shop-bsh\" src=\"./images/bookshops.png\" alt=\"${obj.buy_links[3].name}\"  />\n        </a>\n        </ul>\n        </div>\n        </div>\n        <button class=\"js-modal-clear modal-dlt-btn\" type=\"button\">remove from the shopping list</button>\n        <p class=\"modal-shop-text\">Сongratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”.</p>\n        \n  </div>`\n}\n    \n// =========================================================================\n\nfunction handlerClearBasket(evt) {\n      //  evt.preventDefault();\n   \n\n if (!evt.target.classList.contains('js-modal-clear')) {\n        return;\n    }\n\n    const products = JSON.parse(localStorage.getItem(PRODUCT_LS_KEY)) ?? [];\n \n  const product = evt.target.closest('.js-modal-product');\n  console.log(product);\n  \n    const productId = product.dataset.id;\n\n    const fidx= products.findIndex(option => option._id === productId);\n\n    const currentProduct = products.find(({ _id }) => _id === productId);\n    \n    const deleted = products.splice(fidx, 1);\n\n    localStorage.setItem(PRODUCT_LS_KEY, JSON.stringify(products))\n  \n    window.location.href = './shopping-list.html';\n    \n     return createMarkup(products)\n\n    \n}\n\nrefs.container.addEventListener(\"click\", handlerClearBasket);\n\n"],"names":["$1aafc7bd588ab95c$var$refs","closeModalBtn","document","querySelector","modal","container","book","list","$1aafc7bd588ab95c$var$MODAL_LS_KEY","$1aafc7bd588ab95c$var$PRODUCT_LS_KEY","$1aafc7bd588ab95c$var$products","JSON","parse","localStorage","getItem","$1aafc7bd588ab95c$var$open","querySelectorAll","$1aafc7bd588ab95c$var$i","length","addEventListener","$1aafc7bd588ab95c$var$openModal","evt","target","classList","contains","remove","ref","productId","closest","dataset","id","currentProduct","find","param","_id","setItem","stringify","obj","modalProducts1","insertAdjacentHTML","concat","book_image","title","author","description","buy_links","url","name","add","innerHTML","removeItem","products1","product","console","log","fidx","findIndex","option","splice","window","location","href","createMarkup"],"version":3,"file":"shopping-list.0dc61ded.js.map"}