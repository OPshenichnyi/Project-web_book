{"mappings":"AAAC,MACC,MAAMA,EAAO,CACXC,aAAcC,SAASC,cAAc,qBACrCC,cAAeF,SAASC,cAAc,sBACtCE,MAAOH,SAASC,cAAc,gBAC9BG,UAAWJ,SAASC,cAAc,mBAMpC,SAASI,IACPP,EAAKK,MAAMG,UAAUC,OAAO,aAC5BT,EAAKM,UAAUI,mBAAmB,YAAaC,EAAaC,G,CAL9DZ,EAAKC,aAAaY,iBAAiB,QAASN,GAC5CP,EAAKI,cAAcS,iBAAiB,QAASN,EAM9C,EAfA,GAkBD,MACMK,EAAWE,KAAKC,MAAMC,aAAaC,QADlB,cAC8C,GAGrE,SAASN,EAAaO,GAClB,OAAOA,EAAIC,KAAI,EAACC,IAAEA,EAAGC,MAACA,EAAKC,OAAEA,EAAMC,YAAEA,EAAWC,WAACA,EAAUC,UAAEA,KAAe,yBAE5DL,iHACuBI,WAAoBH,gFAExBA,8DAEKE,0FAGLD,kEAEpBG,EAAU,GAAGC,iJACoCD,EAAU,GAAGE,kDAE9DF,EAAU,GAAGC,uIAC8BD,EAAU,GAAGE,6CAExDF,EAAU,GAAGC,4IACmCD,EAAU,GAAGE,+WAQrEC,KAAK,G,CAIhB,MAAMC,EAAQ3B,SAAS4B,iBAAiB,mBAGxC,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAMG,OAAQD,IAC7BF,EAAME,GAAGlB,iBAAiB,QAASoB,GAMxC,SAASA,EAAmBC,GAI3B,GAHMA,EAAIC,kBAGLD,EAAIE,OAAO5B,UAAU6B,SAAS,kBAC5B,O,IAGaC,EAAjB,MAAMC,EAA2D,QAAhDD,EAAAxB,KAAKC,MAAMC,aAAaC,QAtDtB,oBAsD8C,IAAhDqB,IAAoD,GAI/DE,EAFUN,EAAIE,OAAOK,QAAQ,qBAETC,QAAQC,GAE5BC,EAAML,EAASM,WAAUC,GAAUA,EAAO1B,MAAQoB,IAEjCD,EAASQ,MAAK,EAAC3B,IAAEA,KAAUA,IAAQoB,IAE9CD,EAASS,MAAK,EAAC5B,IAAEA,KAAUA,IAAQoB,IAE/BD,EAASU,OAAOL,EAAM,GAMrC,OAJD5B,aAAakC,QApEM,WAoEkBpC,KAAKqC,UAAUZ,IAEpDa,OAAOC,SAASC,KAAO,uBAEf3C,EAAa4B,E","sources":["src/js/modal-shop.js"],"sourcesContent":["(() => {\n  const refs = {\n    openModalBtn: document.querySelector(\"[data-modal-open]\"),\n    closeModalBtn: document.querySelector(\"[data-modal-close]\"),\n    modal: document.querySelector(\"[data-modal]\"),\n    container: document.querySelector(\".js-modal-item\"),\n  };\n\n  refs.openModalBtn.addEventListener(\"click\", toggleModal);\n  refs.closeModalBtn.addEventListener(\"click\", toggleModal);\n\n  function toggleModal() {\n    refs.modal.classList.toggle(\"is-hidden\");\n    refs.container.insertAdjacentHTML('beforeend', createMarkup(products));\n  }\n})();\n\n\nconst PRODUCT_LS_KEY = 'checkout';\nconst products = JSON.parse(localStorage.getItem(PRODUCT_LS_KEY)) || [];\n\n\nfunction createMarkup(arr) {\n    return arr.map(({ _id,title, author, description,book_image, buy_links}) => `\n\n    <div data-id=\"${_id}\" class=\"js-modal-product modal-shop-product \" data-modal-open=\"\">\n        <img class=\"modal-shop-img\" src=\"${book_image}\" alt=\"${title}\" />\n        <div class=\"book-info\">\n        <h2 class=\"modal-shop-title\">${title}</h2>\n       \n        <p class=\"modal-shop-description\">${description}</p>\n        \n        <div class=\"shop-wrap\">\n        <p class=\"modal-shop-author\">${author}</p>  \n       <ul class =\"shop-link-list\">\n        <a href=\"${buy_links[0].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link shop-link-amz\">\n        <img class=\"icon-shop-amz\" src=\"./images/amazon.png\" alt=\"${buy_links[0].name}\"  />     \n        </a>\n        <a href=\"${buy_links[1].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link shop-link\">\n       <img class=\"icon-shop\" src=\"./images/apple.png\" alt=\"${buy_links[1].name}\" /> \n        </a>\n        <a href=\"${buy_links[3].url}\" target=\"_blank\" rel=\"noreferrer noopener\" class=\"link shop-link\">\n        <img class=\"icon-shop\" src=\"./images/bookshops.png\" alt=\"${buy_links[3].name}\"  /> \n        </a>\n        </ul>\n        \n        </div>\n        <button class=\"js-modal-clear modal-dlt-btn\" type=\"button\">remove from the shopping list</button>\n        <p class=\"modal-shop-text\">Сongratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”.</p>\n        </div>\n  </div>`).join('')\n}\n\n               \nconst clear = document.querySelectorAll('.js-modal-clear')\n\n\nfor (let i = 0; i < clear.length; i++) {\n     clear[i].addEventListener(\"click\", handlerClearBasket\n      \n     );\n }\n// clear.addEventListener('click', handlerClearBasket)\n\nfunction handlerClearBasket(evt) {\n       evt.preventDefault();\n   \n\n if (!evt.target.classList.contains('js-modal-clear')) {\n        return;\n    }\n\n    const products = JSON.parse(localStorage.getItem(PRODUCT_LS_KEY)) ?? [];\n \n    const product = evt.target.closest('.js-modal-product');\n  \n    const productId = product.dataset.id;\n\n    const fidx= products.findIndex(option => option._id === productId);\n\n    const currentProduct = products.find(({ _id }) => _id === productId);\n    \n    const idx = products.some(({ _id }) => _id === productId);\n\n    const deleted = products.splice(fidx, 1);\n\n    localStorage.setItem(PRODUCT_LS_KEY, JSON.stringify(products))\n    \n    window.location.href = './shopping-list.html';\n    \n     return createMarkup(products)\n\n    \n}\n\n\n"],"names":["refs","openModalBtn","document","querySelector","closeModalBtn","modal","container","toggleModal","classList","toggle","insertAdjacentHTML","$047fa90494f5dee5$var$createMarkup","$047fa90494f5dee5$var$products","addEventListener","JSON","parse","localStorage","getItem","arr","map","_id","title","author","description","book_image","buy_links","url","name","join","$047fa90494f5dee5$var$clear","querySelectorAll","i","length","$047fa90494f5dee5$var$handlerClearBasket","evt","preventDefault","target","contains","ref","products1","productId","closest","dataset","id","fidx","findIndex","option","find","some","splice","setItem","stringify","window","location","href"],"version":3,"file":"shopping-list.0de78478.js.map"}